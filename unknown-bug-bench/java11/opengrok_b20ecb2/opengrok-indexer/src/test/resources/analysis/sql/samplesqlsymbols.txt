USE
master
GO
SQLDataFolder
nvarchar
SERVERPROPERTY
nvarchar
nvarchar
SQLDataFolder
SQLDataFolder
SQLDataFolder
GO
USE
AspState
GO
ROLE
ASPStateExecute
ROLE
ASPStateResetRole
ROLE
ASPStateRole
TYPE
dbo
tAppName
TYPE
dbo
tSessionId
nvarchar
TYPE
dbo
tSessionItemLong
image
TYPE
dbo
tSessionItemShort
TYPE
dbo
tTextPtr
dbo
ASPStateTempSessions
SessionId
nvarchar
Latin1_General_100_BIN2
Created
datetime
getutcdate
Expires
datetime
LockDate
datetime
LockDateLocal
datetime
LockCookie
Timeout
Locked
bit
SessionItemShort
SessionItemLong
Flags
INDEX
Index_Expires
NONCLUSTERED
Expires
ASC
KEY
NONCLUSTERED
HASH
SessionId
BUCKET_COUNT
MEMORY_OPTIMIZED
DURABILITY
SCHEMA_ONLY
GO
dbo
ASPStateTempApplications
AppId
AppName
KEY
CLUSTERED
AppId
ASC
PAD_INDEX
OFF
STATISTICS_NORECOMPUTE
OFF
IGNORE_DUP_KEY
OFF
ALLOW_ROW_LOCKS
ALLOW_PAGE_LOCKS
GO
dbo
TempGetStateItemExclusive3_HK
id
nvarchar
itemShort
OUTPUT
locked
bit
OUTPUT
lockAge
OUTPUT
lockCookie
OUTPUT
actionFlags
OUTPUT
NATIVE_COMPILATION
SCHEMABINDING
OWNER
TRANSACTION
ISOLATION
LEVEL
SNAPSHOT
textptr
length
now
datetime
nowLocal
datetime
now
GETUTCDATE
nowLocal
GETDATE
LockedCheck
bit
Flags
LockedCheck
Locked
Flags
Flags
dbo
ASPStateTempSessions
SessionID
id
IF
Flags
actionFlags
dbo
ASPStateTempSessions
Flags
Flags
SessionID
id
actionFlags
IF
LockedCheck
dbo
ASPStateTempSessions
Expires
DATEADD
n
Timeout
now
lockAge
DATEDIFF
LockDate
now
lockCookie
LockCookie
itemShort
length
locked
SessionId
id
dbo
ASPStateTempSessions
Expires
DATEADD
n
Timeout
now
LockDate
now
LockDateLocal
nowlocal
lockAge
lockCookie
LockCookie
LockCookie
itemShort
SessionItemShort
textptr
SessionItemLong
length
locked
Locked
SessionId
id
IF
TextPtr
TextPtr
GO
dbo
TempGetStateItemExclusive3
id
nvarchar
itemShort
OUTPUT
locked
bit
OUTPUT
lockAge
OUTPUT
lockCookie
OUTPUT
actionFlags
OUTPUT
retry
WHILE
retry
TRY
TRANSACTION
dbo
TempGetStateItemExclusive3_HK
id
itemShort
itemShort
OUTPUT
locked
locked
OUTPUT
lockAge
lockAge
OUTPUT
lockCookie
lockCookie
OUTPUT
actionFlags
actionFlags
OUTPUT
TRANSACTION
retry
TRY
CATCH
retry
IF
retry
ERROR_NUMBER
IF
XACT_STATE
TRANSACTION
WAITFOR
DELAY
PRINT
THROW
CATCH
GO
dbo
TempInsertStateItemShort_HK
id
nvarchar
itemShort
timeout
NATIVE_COMPILATION
SCHEMABINDING
OWNER
TRANSACTION
ISOLATION
LEVEL
SNAPSHOT
now
datetime
nowLocal
datetime
now
GETUTCDATE
nowLocal
GETDATE
dbo
ASPStateTempSessions
SessionId
SessionItemShort
Timeout
Expires
Locked
LockDate
LockDateLocal
LockCookie
Created
Flags
SessionItemLong
id
itemShort
timeout
DATEADD
n
timeout
now
now
nowLocal
now
GO
dbo
TempInsertStateItemShort
id
nvarchar
itemShort
timeout
retry
WHILE
retry
TRY
TRANSACTION
dbo
TempInsertStateItemShort_HK
id
itemShort
timeout
TRANSACTION
retry
TRY
CATCH
retry
IF
retry
ERROR_NUMBER
IF
XACT_STATE
TRANSACTION
WAITFOR
DELAY
PRINT
THROW
CATCH
GO
dbo
TempUpdateStateItemLong_HK
id
nvarchar
itemLong
timeout
lockCookie
NATIVE_COMPILATION
SCHEMABINDING
OWNER
TRANSACTION
ISOLATION
LEVEL
SNAPSHOT
dbo
ASPStateTempSessions
Expires
DATEADD
n
timeout
GETUTCDATE
SessionItemLong
itemLong
Timeout
timeout
Locked
SessionId
id
LockCookie
lockCookie
GO
dbo
TempUpdateStateItemLong
id
nvarchar
itemLong
timeout
lockCookie
retry
WHILE
retry
TRY
TRANSACTION
dbo
TempUpdateStateItemLong_HK
id
itemLong
timeout
lockCookie
TRANSACTION
retry
TRY
CATCH
retry
IF
retry
ERROR_NUMBER
IF
XACT_STATE
TRANSACTION
WAITFOR
DELAY
PRINT
THROW
CATCH
GO
dbo
TempUpdateStateItemLongNullShort_HK
id
nvarchar
itemLong
timeout
lockCookie
NATIVE_COMPILATION
SCHEMABINDING
OWNER
TRANSACTION
ISOLATION
LEVEL
SNAPSHOT
dbo
ASPStateTempSessions
Expires
DATEADD
n
timeout
GETUTCDATE
SessionItemLong
itemLong
SessionItemShort
Timeout
timeout
Locked
SessionId
id
LockCookie
lockCookie
GO
dbo
TempUpdateStateItemLongNullShort
id
nvarchar
itemLong
timeout
lockCookie
retry
WHILE
retry
TRY
TRANSACTION
dbo
TempUpdateStateItemLongNullShort_HK
id
itemLong
timeout
lockCookie
TRANSACTION
retry
TRY
CATCH
retry
IF
retry
ERROR_NUMBER
IF
XACT_STATE
TRANSACTION
WAITFOR
DELAY
PRINT
THROW
CATCH
GO
dbo
TempUpdateStateItemShort_HK
id
nvarchar
itemShort
timeout
lockCookie
NATIVE_COMPILATION
SCHEMABINDING
OWNER
TRANSACTION
ISOLATION
LEVEL
SNAPSHOT
dbo
ASPStateTempSessions
Expires
DATEADD
n
timeout
GETUTCDATE
SessionItemShort
itemShort
Timeout
timeout
Locked
SessionId
id
LockCookie
lockCookie
GO
dbo
TempUpdateStateItemShort
id
nvarchar
itemShort
timeout
lockCookie
retry
WHILE
retry
TRY
TRANSACTION
dbo
TempUpdateStateItemShort_HK
id
itemShort
timeout
lockCookie
TRANSACTION
retry
TRY
CATCH
retry
IF
retry
ERROR_NUMBER
IF
XACT_STATE
TRANSACTION
WAITFOR
DELAY
PRINT
THROW
CATCH
GO
dbo
CreateTempTables
ASPStateTempSessions
SessionId
nvarchar
Latin1_General_100_BIN2
Created
datetime
GETUTCDATE
Expires
datetime
LockDate
datetime
LockDateLocal
datetime
LockCookie
Timeout
Locked
bit
SessionItemShort
SessionItemLong
Flags
KEY
NONCLUSTERED
HASH
SessionId
BUCKET_COUNT
INDEX
Index_Expires
Expires
MEMORY_OPTIMIZED
DURABILITY
SCHEMA_ONLY
dbo
ASPStateTempApplications
AppId
KEY
AppName
NONCLUSTERED
INDEX
Index_AppName
ASPStateTempApplications
AppName
GO
dbo
DeleteExpiredSessions
NOCOUNT
DEADLOCK_PRIORITY
LOW
now
datetime
now
GETUTCDATE
tblExpiredSessions
SessionId
nvarchar
KEY
tblExpiredSessions
SessionId
SessionId
ASPStateTempSessions
SNAPSHOT
Expires
now
IF
ROWCOUNT
ExpiredSessionCursor
FORWARD_ONLY
READ_ONLY
SessionId
tblExpiredSessions
SessionId
nvarchar
ExpiredSessionCursor
NEXT
ExpiredSessionCursor
SessionId
WHILE
FETCH_STATUS
ASPStateTempSessions
SessionId
SessionId
Expires
now
NEXT
ExpiredSessionCursor
SessionId
ExpiredSessionCursor
ExpiredSessionCursor
tblExpiredSessions
GO
dbo
GetHashCode
input
tAppName
hash
OUTPUT
hi_16bit
lo_16bit
hi_t
lo_t
len
i
c
carry
hi_16bit
lo_16bit
len
DATALENGTH
input
i
WHILE
i
len
c
ASCII
input
i
hi_t
hi_16bit
hi_t
hi_t
lo_t
lo_16bit
carry
lo_16bit
carry
carry
hi_t
hi_t
carry
hi_t
hi_t
lo_16bit
lo_16bit
lo_t
hi_16bit
hi_16bit
hi_t
lo_16bit
lo_16bit
lo_16bit
c
hi_16bit
hi_16bit
lo_16bit
lo_16bit
i
i
IF
hi_16bit
hi_16bit
hi_16bit
hi_16bit
hi_16bit
hash
hi_16bit
lo_16bit
GO
dbo
GetMajorVersion
ver
OUTPUT
version
dot
hyphen
SqlToExec
ver
version
Version
hyphen
CHARINDEX
version
IF
hyphen
hyphen
hyphen
hyphen
dot
CHARINDEX
version
hyphen
IF
dot
dot
hyphen
version
version
hyphen
dot
hyphen
ver
version
GO
dbo
TempGetAppID
appName
appId
OUTPUT
appName
appName
appId
appId
AppId
ASPStateTempApplications
AppName
appName
IF
appId
TRAN
appId
AppId
ASPStateTempApplications
TABLOCKX
AppName
appName
IF
appId
GetHashCode
appName
appId
OUTPUT
ASPStateTempApplications
appId
appName
IF
ERROR
dupApp
tAppName
dupApp
RTRIM
AppName
ASPStateTempApplications
AppId
appId
RAISERROR
appName
dupApp
GO
dbo
TempGetStateItem
id
tSessionId
itemShort
tSessionItemShort
OUTPUT
locked
bit
OUTPUT
lockDate
datetime
OUTPUT
lockCookie
OUTPUT
textptr
tTextPtr
length
now
datetime
now
GETUTCDATE
retry
WHILE
retry
TRY
TRANSACTION
ASPStateTempSessions
Expires
DATEADD
n
Timeout
now
locked
Locked
lockDate
LockDateLocal
lockCookie
LockCookie
itemShort
locked
SessionItemShort
textptr
locked
SessionItemLong
length
locked
DATALENGTH
SessionItemLong
SessionId
id
IF
length
textptr
TRANSACTION
retry
TRY
CATCH
retry
IF
retry
ERROR_NUMBER
IF
XACT_STATE
TRANSACTION
WAITFOR
DELAY
PRINT
THROW
CATCH
GO
dbo
TempGetStateItem2
id
tSessionId
itemShort
tSessionItemShort
OUTPUT
locked
bit
OUTPUT
lockAge
OUTPUT
lockCookie
OUTPUT
textptr
tTextPtr
length
now
datetime
now
GETUTCDATE
retry
WHILE
retry
TRY
TRANSACTION
ASPStateTempSessions
Expires
DATEADD
n
Timeout
now
locked
Locked
lockAge
DATEDIFF
LockDate
now
lockCookie
LockCookie
itemShort
locked
SessionItemShort
textptr
locked
SessionItemLong
length
locked
DATALENGTH
SessionItemLong
SessionId
id
IF
length
textptr
TRANSACTION
retry
TRY
CATCH
retry
IF
retry
ERROR_NUMBER
IF
XACT_STATE
TRANSACTION
WAITFOR
DELAY
PRINT
THROW
CATCH
GO
dbo
TempGetStateItem3
id
nvarchar
itemShort
OUTPUT
locked
bit
OUTPUT
lockAge
OUTPUT
lockCookie
OUTPUT
actionFlags
OUTPUT
textptr
tTextPtr
length
now
datetime
now
GETUTCDATE
retry
WHILE
retry
TRY
TRANSACTION
ASPStateTempSessions
Expires
DATEADD
n
Timeout
now
locked
Locked
lockAge
DATEDIFF
LockDate
now
lockCookie
LockCookie
itemShort
locked
SessionItemShort
textptr
locked
SessionItemLong
length
locked
DATALENGTH
SessionItemLong
Flags
Flags
Flags
Flags
actionFlags
Flags
SessionId
id
IF
length
textptr
TRANSACTION
retry
TRY
CATCH
retry
IF
retry
ERROR_NUMBER
IF
XACT_STATE
TRANSACTION
WAITFOR
DELAY
PRINT
THROW
CATCH
GO
dbo
TempGetStateItemExclusive
id
tSessionId
itemShort
tSessionItemShort
OUTPUT
locked
bit
OUTPUT
lockDate
datetime
OUTPUT
lockCookie
OUTPUT
textptr
tTextPtr
length
now
datetime
nowLocal
datetime
now
GETUTCDATE
nowLocal
GETDATE
retry
WHILE
retry
TRY
TRANSACTION
ASPStateTempSessions
Expires
DATEADD
n
Timeout
now
LockDate
Locked
now
LockDate
lockDate
LockDateLocal
Locked
nowLocal
LockDateLocal
lockCookie
LockCookie
Locked
LockCookie
LockCookie
itemShort
Locked
SessionItemShort
textptr
Locked
SessionItemLong
length
Locked
DATALENGTH
SessionItemLong
locked
Locked
Locked
SessionId
id
IF
length
textptr
TRANSACTION
retry
TRY
CATCH
retry
IF
retry
ERROR_NUMBER
IF
XACT_STATE
TRANSACTION
WAITFOR
DELAY
PRINT
THROW
CATCH
GO
dbo
TempGetStateItemExclusive2
id
tSessionId
itemShort
tSessionItemShort
OUTPUT
locked
bit
OUTPUT
lockAge
OUTPUT
lockCookie
OUTPUT
textptr
tTextPtr
length
now
datetime
nowLocal
datetime
now
GETUTCDATE
nowLocal
GETDATE
retry
WHILE
retry
TRY
TRANSACTION
ASPStateTempSessions
Expires
DATEADD
n
Timeout
now
LockDate
Locked
now
LockDate
LockDateLocal
Locked
nowLocal
LockDateLocal
lockAge
Locked
DATEDIFF
LockDate
now
lockCookie
LockCookie
Locked
LockCookie
LockCookie
itemShort
Locked
SessionItemShort
textptr
Locked
SessionItemLong
length
Locked
DATALENGTH
SessionItemLong
locked
Locked
Locked
SessionId
id
IF
length
textptr
TRANSACTION
retry
TRY
CATCH
retry
IF
retry
ERROR_NUMBER
IF
XACT_STATE
TRANSACTION
WAITFOR
DELAY
PRINT
THROW
CATCH
GO
dbo
TempGetVersion
ver
OUTPUT
ver
GO
dbo
TempInsertStateItemLong
id
nvarchar
itemLong
image
timeout
now
datetime
nowLocal
datetime
now
GETUTCDATE
nowLocal
GETDATE
retry
WHILE
retry
TRY
TRANSACTION
ASPStateTempSessions
SessionId
SessionItemLong
Timeout
Expires
Locked
LockDate
LockDateLocal
LockCookie
id
itemLong
timeout
DATEADD
n
timeout
now
now
nowLocal
TRANSACTION
retry
TRY
CATCH
retry
IF
retry
ERROR_NUMBER
IF
XACT_STATE
TRANSACTION
WAITFOR
DELAY
PRINT
THROW
CATCH
GO
dbo
TempInsertUninitializedItem
id
nvarchar
itemShort
timeout
now
datetime
nowLocal
datetime
now
GETUTCDATE
nowLocal
GETDATE
retry
WHILE
retry
TRY
TRANSACTION
ASPStateTempSessions
SessionId
SessionItemShort
Timeout
Expires
Locked
LockDate
LockDateLocal
LockCookie
Flags
id
itemShort
timeout
DATEADD
n
timeout
now
now
nowLocal
TRANSACTION
retry
TRY
CATCH
retry
IF
retry
ERROR_NUMBER
IF
XACT_STATE
TRANSACTION
WAITFOR
DELAY
PRINT
THROW
CATCH
GO
dbo
TempReleaseStateItemExclusive
id
nvarchar
lockCookie
retry
WHILE
retry
TRY
TRANSACTION
ASPStateTempSessions
Expires
DATEADD
n
Timeout
GETUTCDATE
Locked
SessionId
id
LockCookie
lockCookie
TRANSACTION
retry
TRY
CATCH
retry
IF
retry
ERROR_NUMBER
IF
XACT_STATE
TRANSACTION
WAITFOR
DELAY
PRINT
THROW
CATCH
GO
dbo
TempRemoveStateItem
id
nvarchar
lockCookie
retry
WHILE
retry
TRY
TRANSACTION
ASPStateTempSessions
SessionId
id
LockCookie
lockCookie
TRANSACTION
retry
TRY
CATCH
retry
IF
retry
ERROR_NUMBER
IF
XACT_STATE
TRANSACTION
WAITFOR
DELAY
PRINT
THROW
CATCH
GO
dbo
TempResetTimeout
id
nvarchar
retry
WHILE
retry
TRY
TRANSACTION
ASPStateTempSessions
Expires
DATEADD
n
Timeout
GETUTCDATE
SessionId
id
TRANSACTION
retry
TRY
CATCH
retry
IF
retry
ERROR_NUMBER
IF
XACT_STATE
TRANSACTION
WAITFOR
DELAY
PRINT
THROW
CATCH
GO
dbo
TempUpdateStateItemShortNullLong
id
nvarchar
itemShort
timeout
lockCookie
retry
WHILE
retry
TRY
TRANSACTION
ASPStateTempSessions
Expires
DATEADD
n
timeout
GETUTCDATE
SessionItemShort
itemShort
SessionItemLong
Timeout
timeout
Locked
SessionId
id
LockCookie
lockCookie
TRANSACTION
retry
TRY
CATCH
retry
IF
retry
ERROR_NUMBER
IF
XACT_STATE
TRANSACTION
WAITFOR
DELAY
PRINT
THROW
CATCH
GO
